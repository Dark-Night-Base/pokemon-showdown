export const typeToPoint: {[k: string]: number} = {
	bug: 0.8,
	dark: 1.6,
	dragon: 1.4,
	electric: 1.6,
	fairy: 1.8,
	fighting: 1.2,
	fire: 1.6,
	flying: 1.6,
	ghost: 1.8,
	grass: 1.2,
	ground: 1.6,
	ice: 1.4,
	normal: 1.6,
	poison: 1.2,
	psychic: 1,
	rock: 1.2,
	steel: 2,
	stellar: 1,
	water: 1.8,
};
export const abilityToPoint: {[k: string]: number} = {
	adaptability: 3,
	aerilate: 3,
	arenatrap: 1000000,
	armortail: 2.5,
	asoneglastrier: 1.5,
	asonespectrier: 1.5,
	battlebond: 1000000,
	beadsofruin: 3.5,
	beastboost: 1.5,
	chillingneigh: 1.5,
	chlorophyll: 2,
	comatose: 1.5,
	contrary: 5,
	corrosion: 2,
	darkaura: 1.5,
	dazzling: 2.5,
	defeatist: 1,
	desolateland: 3.5,
	disguise: 1000000,
	download: 2,
	dragonsmaw: 3,
	drizzle: 4,
	drought: 4,
	dryskin: 2,
	eartheater: 2,
	electricsurge: 3,
	embodyaspectcornerstone: 1000000,
	embodyaspecthearthflame: 1000000,
	embodyaspectteal: 1000000,
	embodyaspectwellspring: 1000000,
	fairyaura: 1.5,
	filter: 1.5,
	flareboost: 2,
	flashfire: 2,
	flowergift: 1000000,
	fluffy: 3,
	forecast: 1000000,
	furcoat: 3.5,
	galewings: 1.5,
	galvanize: 2,
	goodasgold: 3.5,
	gorillatactics: 4.5,
	grassysurge: 1.5,
	grimneigh: 1.5,
	gulpmissile: 1000000,
	guts: 2,
	hugepower: 1000000,
	hungerswitch: 1000000,
	hustle: 2.5,
	hadronengine: 5,
	iceface: 1000000,
	icescales: 3.5,
	illusion: 5,
	imposter: 50,
	innardsout: 1000000,
	intimidate: 2.5,
	intrepidsword: 1.5,
	levitate: 1.5,
	libero: 3,
	lightningrod: 2.5,
	magicbounce: 3,
	magicguard: 3.5,
	magnetpull: 5,
	megalauncher: 2,
	mindseye: 1.5,
	mistysurge: 2,
	moldbreaker: 3,
	moody: 1000000,
	motordrive: 2,
	moxie: 1.5,
	multiscale: 2,
	multitype: 1000000,
	neuroforce: 1.5,
	neutralizinggas: 1000000,
	noguard: 3,
	normalize: 4,
	orichalcumpulse: 5,
	parentalbond: 1000000,
	pixilate: 3.5,
	poisonheal: 4,
	poisonpuppeteer: 1000000,
	powerconstruct: 1000000,
	prankster: 3,
	pressure: 1.5,
	primordialsea: 3.5,
	prismarmor: 1.5,
	protean: 3,
	protosynthesis: 2,
	psychicsurge: 3.5,
	punkrock: 1.5,
	purepower: 1000000,
	purifyingsalt: 1.5,
	quarkdrive: 2,
	queenlymajesty: 2.5,
	quickdraw: 1.5,
	refrigerate: 2.5,
	regenerator: 4,
	rkssystem: 1000000,
	rockhead: 1.5,
	rockypayload: 2,
	sandrush: 1.5,
	sandstream: 2.5,
	sandveil: 1000000,
	sapsipper: 2,
	schooling: 1000000,
	scrappy: 1.5,
	serenegrace: 1.5,
	shadowshield: 2,
	shadowtag: 1000000,
	sharpness: 1.5,
	sheerforce: 2.5,
	shielddust: 1.5,
	shieldsdown: 1000000,
	simple: 2.5,
	skilllink: 1.5,
	slowstart: 1,
	slushrush: 1.5,
	sniper: 2.5,
	snowcloak: 1000000,
	snowwarning: 2,
	solarpower: 1.5,
	solidrock: 1.5,
	soulheart: 1.5,
	soundproof: 2,
	speedboost: 2.5,
	stakeout: 5,
	stamina: 1.5,
	stancechange: 1000000,
	steelworker: 2.5,
	steelyspirit: 2.5,
	stormdrain: 2,
	strongjaw: 2,
	sturdy: 1.5,
	surgesurfer: 2,
	swiftswim: 2.5,
	swordofruin: 3.5,
	tabletsofruin: 2,
	technician: 2,
	teraformzero: 1000000,
	terashell: 1000000,
	terashift: 1000000,
	teravolt: 3,
	thickfat: 1.5,
	tintedlens: 3,
	toughclaws: 3,
	toxicboost: 1.5,
	transistor: 2,
	triage: 3.5,
	truant: 0.5,
	turboblaze: 3,
	unaware: 3,
	unburden: 3,
	unseenfist: 1.5,
	vesselofruin: 2,
	voltabsorb: 2,
	waterabsorb: 2,
	waterbubble: 1000000,
	wellbakedbody: 2.5,
	wonderguard: 1000000,
	zenmode: 1000000,
	zerotohero: 1000000,
};
export const moveToPoint: {[k: string]: number} = {
	acidarmor: 1,
	acidspray: 1,
	acrobatics: 1.5,
	acupressure: 1,
	aeroblast: 1,
	alluringvoice: 1,
	anchorshot: 1,
	appleacid: 1.5,
	aquastep: 1.5,
	aquatail: 1,
	armorcannon: 2,
	aromatherapy: 1.5,
	assist: 1,
	astralbarrage: 2,
	attackorder: 1,
	aurasphere: 1,
	aurawheel: 2,
	auroraveil: 1.5,
	axekick: 2,
	baddybad: 2,
	banefulbunker: 1,
	barbbarrage: 1,
	barrier: 1,
	batonpass: 1.5,
	beakblast: 1,
	behemothbash: 1,
	behemothblade: 1,
	belch: 1.5,
	bellydrum: 2.5,
	bitterblade: 1.5,
	bittermalice: 1,
	blastburn: 1.5,
	blazekick: 1,
	blazingtorque: 1.5,
	bleakwindstorm: 1.5,
	blizzard: 1.5,
	block: 1,
	bloodmoon: 2,
	blueflare: 2,
	bodypress: 1.5,
	bodyslam: 1.5,
	boltbeak: 2.5,
	boltstrike: 2,
	bonemerang: 1,
	boomburst: 2,
	bounce: 1.5,
	bravebird: 2,
	bugbuzz: 1,
	bulkup: 1.5,
	burningbulwark: 1,
	burnup: 1.5,
	buzzybuzz: 1,
	calmmind: 1.5,
	ceaselessedge: 1.5,
	chatter: 1,
	chillyreception: 1.5,
	chloroblast: 2,
	clangingscales: 1.5,
	clangoroussoul: 1.5,
	closecombat: 2,
	coil: 1.5,
	collisioncourse: 1.5,
	combattorque: 1.5,
	comeuppance: 1,
	copycat: 1,
	coreenforcer: 1.5,
	corrosivegas: 1.5,
	cosmicpower: 1.5,
	cottonguard: 1.5,
	counter: 1,
	courtchange: 2,
	crabhammer: 1,
	crosschop: 1,
	crunch: 1,
	crushclaw: 1,
	curse: 1,
	darkestlariat: 1,
	darkpulse: 1,
	darkvoid: 2,
	dazzlinggleam: 1,
	defendorder: 1.5,
	destinybond: 2,
	diamondstorm: 1.5,
	dig: 1,
	direclaw: 2,
	disable: 1,
	discharge: 1.5,
	dive: 1,
	doomdesire: 2,
	doubleedge: 2,
	doubleironbash: 1000000,
	doubleshock: 1.5,
	doubleteam: 1000000,
	dracometeor: 2,
	dragonascent: 2,
	dragonclaw: 1,
	dragondance: 2,
	dragondarts: 1,
	dragonenergy: 2,
	dragonhammer: 1,
	dragonpulse: 1,
	dragonrush: 1,
	drainpunch: 1,
	dreameater: 1,
	drillpeck: 1,
	drillrun: 1,
	drumbeating: 1.5,
	dualchop: 1,
	dualwingbeat: 1,
	dynamaxcannon: 1,
	dynamicpunch: 1.5,
	earthpower: 1,
	earthquake: 1,
	eeriespell: 1,
	eggbomb: 1,
	electrify: 1.5,
	electrodrift: 1.5,
	electroshot: 2.5,
	encore: 1.5,
	endeavor: 1.5,
	energyball: 1,
	entrainment: 1.5,
	eruption: 2,
	esperwing: 1.5,
	eternabeam: 2,
	expandingforce: 2,
	explosion: 2.5,
	extrasensory: 1,
	extremespeed: 1.5,
	facade: 2,
	fairylock: 1,
	fakeout: 1,
	falsesurrender: 1,
	ficklebeam: 1.5,
	fierydance: 1.5,
	fierywrath: 1,
	filletaway: 2,
	finalgambit: 1000000,
	fireblast: 1.5,
	firelash: 1.5,
	firepledge: 1,
	firstimpression: 1.5,
	fishiousrend: 2.5,
	fissure: 1000000,
	flail: 2,
	flamethrower: 1,
	flareblitz: 2,
	flashcannon: 1,
	fleurcannon: 2,
	floatyfall: 1.5,
	flowertrick: 1.5,
	fly: 1,
	flyingpress: 1,
	focusblast: 2,
	focuspunch: 1.5,
	foulplay: 1,
	freezeshock: 1.5,
	freezingglare: 1,
	freezyfrost: 1,
	frenzyplant: 1.5,
	frostbreath: 1,
	frustration: 1.5,
	fusionbolt: 1,
	fusionflare: 1,
	futuresight: 2,
	gastroacid: 1,
	geargrind: 1,
	geomancy: 1.5,
	gigadrain: 1,
	gigaimpact: 1.5,
	gigatonhammer: 2.5,
	glaciallance: 2,
	glaciate: 1,
	glaiverush: 2,
	glare: 1.5,
	glitzyglow: 2,
	grassknot: 1,
	grasspledge: 1,
	grasswhistle: 2,
	gravapple: 1.5,
	growth: 1.5,
	guillotine: 1000000,
	gunkshot: 2,
	hammerarm: 1,
	haze: 1,
	headcharge: 2,
	headlongrush: 2,
	headsmash: 2,
	healbell: 1.5,
	healblock: 1,
	healingwish: 1.5,
	healorder: 2,
	heartswap: 1,
	heatcrash: 1,
	heatwave: 1,
	heavyslam: 1,
	hex: 1,
	highhorsepower: 1,
	highjumpkick: 2,
	honeclaws: 1,
	horndrill: 1000000,
	hornleech: 1,
	howl: 1,
	hurricane: 2,
	hydrocannon: 1.5,
	hydropump: 1.5,
	hydrosteam: 1,
	hyperbeam: 1.5,
	hyperdrill: 1,
	hyperfang: 1,
	hyperspacefury: 1,
	hyperspacehole: 1,
	hypersteam: 1.5,
	hypervoice: 1,
	hypnosis: 2,
	icebeam: 1,
	iceburn: 1.5,
	icehammer: 1,
	icespinner: 1,
	iciclecrash: 1.5,
	imprison: 1000000,
	inferno: 1.5,
	irondefense: 1,
	ironhead: 1.5,
	irontail: 1.5,
	ivycudgel: 1,
	jawlock: 1,
	judgment: 1,
	jumpkick: 1,
	junglehealing: 1,
	kingsshield: 1,
	knockoff: 1.5,
	kowtowcleave: 1,
	landswrath: 1,
	lastresort: 1.5,
	lastrespects: 2.5,
	lavaplume: 1.5,
	leafblade: 1,
	leafstorm: 2,
	leaftornado: 1,
	leechlife: 1.5,
	leechseed: 1,
	lightofruin: 2,
	lightscreen: 1.5,
	liquidation: 1,
	lovelykiss: 2,
	lowkick: 1,
	lowsweep: 1,
	luminacrash: 2,
	lunarblessing: 1,
	lunardance: 1.5,
	lunge: 1.5,
	lusterpurge: 1.5,
	magicaltorque: 1.5,
	magmastorm: 1.5,
	makeitrain: 2,
	malignantchain: 1.5,
	matchagotcha: 1.5,
	meanlook: 1,
	meditate: 1,
	megahorn: 2,
	megakick: 2,
	megapunch: 1,
	memento: 1.5,
	metalburst: 1,
	meteorassault: 1.5,
	meteorbeam: 2,
	meteormash: 1,
	mightycleave: 1,
	milkdrink: 1.5,
	mindblown: 2,
	minimize: 1000000,
	mirrorcoat: 1,
	mirrormove: 1,
	mistball: 1.5,
	mistyexplosion: 1,
	moonblast: 1.5,
	moongeistbeam: 1.5,
	moonlight: 1.5,
	morningsun: 1.5,
	mortalspin: 1,
	mountaingale: 1.5,
	muddywater: 1.5,
	multiattack: 1,
	mysticalfire: 1,
	mysticalpower: 1,
	nastyplot: 1.5,
	naturepower: 1,
	naturesmadness: 1.5,
	nightdaze: 1.5,
	noretreat: 2,
	noxioustorque: 1.5,
	oblivionwing: 1.5,
	obstruct: 1,
	octazooka: 1,
	octolock: 1000000,
	orderup: 1,
	originpulse: 1.5,
	outrage: 2,
	overdrive: 1,
	overheat: 2,
	paraboliccharge: 1,
	partingshot: 1.5,
	perishsong: 1.5,
	petalblizzard: 1,
	petaldance: 2,
	phantomforce: 1,
	photongeyser: 1.5,
	pikapapow: 1.5,
	plasmafists: 1,
	playrough: 1,
	poisonjab: 1.5,
	pollenpuff: 1,
	poltergeist: 1.5,
	populationbomb: 2.5,
	powergem: 1,
	powertrick: 1,
	powertrip: 1000000,
	powerwhip: 2,
	precipiceblades: 2,
	prismaticlaser: 2,
	protect: 1,
	psyblade: 2,
	psychic: 1,
	psychicfangs: 1,
	psychicnoise: 1.5,
	psychoboost: 2,
	psychoshift: 1.5,
	psychup: 1,
	psyshieldbash: 1,
	psyshock: 1,
	psystrike: 1,
	purify: 1,
	pursuit: 1,
	pyroball: 2,
	quiverdance: 2,
	ragefist: 1000000,
	ragingbull: 1,
	ragingfury: 2,
	rapidspin: 1,
	razorshell: 1,
	razorwind: 1,
	recover: 1.5,
	recycle: 1,
	reflect: 1.5,
	relicsong: 1.5,
	return: 1.5,
	revelationdance: 1,
	reversal: 2,
	revivalblessing: 1000000,
	risingvoltage: 2,
	roar: 1,
	roaroftime: 1.5,
	rockclimb: 1,
	rockwrecker: 1.5,
	roost: 1.5,
	ruination: 1.5,
	sacredfire: 1.5,
	sacredsword: 1,
	saltcure: 1,
	sandsearstorm: 1,
	sappyseed: 1.5,
	scald: 1.5,
	searingshot: 1.5,
	secretsword: 1,
	seedbomb: 1,
	seedflare: 2,
	selfdestruct: 2.5,
	shadowball: 1,
	shadowbone: 1,
	shadowforce: 2,
	sharpen: 1,
	shedtail: 1000000,
	sheercold: 1000000,
	shellsidearm: 1,
	shellsmash: 2.5,
	shelltrap: 1.5,
	shelter: 1,
	shiftgear: 2,
	shoreup: 1.5,
	silktrap: 1,
	sing: 2,
	skillswap: 1.5,
	skittersmack: 1,
	skullbash: 1.5,
	skyattack: 1.5,
	skyuppercut: 1,
	slackoff: 1.5,
	slam: 1,
	sleeppowder: 2,
	sleeptalk: 1.5,
	sludgebomb: 1.5,
	sludgewave: 1,
	snipeshot: 1,
	softboiled: 1.5,
	solarbeam: 2,
	solarblade: 2,
	spacialrend: 1,
	sparklingaria: 1,
	sparklyswirl: 2.5,
	spectralthief: 1.5,
	spikes: 1.5,
	spikyshield: 1,
	spinout: 1,
	spiritbreak: 1,
	spiritshackle: 1,
	spite: 1,
	splishysplash: 1.5,
	spore: 2.5,
	springtidestorm: 1.5,
	stealthrock: 1.5,
	steameruption: 2,
	steelbeam: 2,
	steelroller: 1.5,
	stickyweb: 2,
	stoneaxe: 1.5,
	stoneedge: 1,
	storedpower: 2,
	stormthrow: 1,
	strangesteam: 1,
	strength: 1,
	strengthsap: 1.5,
	submission: 1,
	substitute: 2.5,
	suckerpunch: 1,
	sunsteelstrike: 1.5,
	supercellslam: 1,
	superfang: 1.5,
	superpower: 2,
	surf: 1,
	surgingstrikes: 1.5,
	switcheroo: 1.5,
	swordsdance: 1.5,
	synchronoise: 1.5,
	synthesis: 1.5,
	tachyoncutter: 1,
	tailglow: 2,
	tailwind: 1,
	takedown: 1,
	takeheart: 2,
	taunt: 2,
	technoblast: 1,
	teleport: 1.5,
	terablast: 1,
	terastarstorm: 2,
	terrainpulse: 1,
	thousandarrows: 1.5,
	thousandwaves: 1,
	thrash: 2,
	throatchop: 1,
	thunder: 2,
	thunderbolt: 1,
	thundercage: 1.5,
	thunderclap: 1,
	thunderouskick: 1.5,
	thunderwave: 1,
	tidyup: 2,
	topsyturvy: 1.5,
	torchsong: 1.5,
	toxic: 1.5,
	toxicspikes: 1.5,
	toxicthread: 1,
	transform: 2.5,
	triattack: 1,
	trick: 1.5,
	trickroom: 1.5,
	triplearrows: 1.5,
	tripleaxel: 2,
	tripledive: 1,
	tropkick: 1,
	twinbeam: 1,
	upperhand: 1.5,
	uproar: 1,
	uturn: 1,
	vcreate: 2.5,
	veeveevolley: 1.5,
	venoshock: 1,
	victorydance: 2,
	voltswitch: 1,
	volttackle: 2,
	waterfall: 1,
	waterpledge: 1,
	waterspout: 2,
	wavecrash: 2,
	weatherball: 1,
	whirlwind: 1,
	wickedblow: 1.5,
	wickedtorque: 2,
	wildboltstorm: 1,
	wildcharge: 1,
	willowisp: 1.5,
	wish: 1,
	woodhammer: 2,
	workup: 1,
	worryseed: 1,
	xscissor: 1,
	yawn: 1.5,
	zapcannon: 2.5,
	zenheadbutt: 1,
	zingzap: 1.5,
	zippyzap: 1000000,
};
function calcBSPoint(stats: StatsTable) {
	let statName: StatID;
	for (statName in stats) stats[statName] = stats[statName] || 1;
	const h = stats['hp'];
	const a = stats['atk'];
	const b = stats['def'];
	const c = stats['spa'];
	const d = stats['spd'];
	const s = stats['spe'];
	const A = (a: number) => 2 * a + 100;
	const B = (h: number, b: number) => (2 * h + 200) * (2 * b + 100);
	const S = A;
	const f = (x: number) => x * x * x * 11 - x * x * 25 + x * 19 - 0.75;
	const g = (x: number) => x * x * x * 10 - x * x * 18 + x * 10 + 2;
	const k = (x: number) => - x * x * x * x + x * x * x * 8 - x * x * 10 + x * 3 + 1;
	const A_w = (4 * Math.max(A(a), A(c)) + 1 * Math.min(A(a), A(c))) / 15e2;
	const B_w = (2 * Math.max(B(h, b), B(h, d)) + 1 * Math.min(B(h, b), B(h, d))) / 36e4;
	const E = S(s) / 300;
	const f_A_w = f(A_w);
	const g_B_w = g(B_w);
	const k_E = k(E);
	const bs = Math.floor(f_A_w * g_B_w * k_E * 10);
	return [bs, f_A_w, g_B_w, k_E];
}
function calcPnPoint(stat: number, version = 1, a = 9, b = 180, c = 100000): number {
	switch (version) {
	case 0:
		if (stat <= 150) return 0;
		return 5000;
	case 1:
		if (stat <= 150) return 0;
		// (stat-150)^3/10.61
		stat = (stat - 150) * (stat - 150) * (stat - 150) * 193 / 2048;
		return Math.floor(stat);
	case 2:
		// sigmoid-like function
		// c/(1+a*e^(-(x-b)/a))
		stat = Math.floor(stat);
		stat = - (stat - b) / a;
		stat = 1 + a * Math.exp(stat);
		stat = c / stat;
		return Math.floor(stat);
	case 2.5:
		return calcPnPoint(stat, 2, 10, 120, 5000) + calcPnPoint(stat, 2, 10, 180, 95000);
	default:
		return 0;
	}
}
export function getSetPoint(dex: ModdedDex, set: PokemonSet) {
	// BS | BSA | BSB | BSE | T | T1 | T2 | A | M | M1 | M2 | M3 | M4
	//  0 |  1  |  2  |  3  | 4 |  5 |  6 | 7 | 8 |  9 | 10 | 11 | 12
	const details: number[] = [];
	const species = dex.species.get(set.species);

	// stats points
	if (!set.evs) set.evs = JSON.parse(JSON.stringify(species.baseStats));
	const bsDetails = calcBSPoint(set.evs);
	details.push(...bsDetails);

	// type points
	const types: string[] = [];
	if (set.hpType && dex.types.get(set.hpType).exists) {
		types.push(dex.types.get(set.hpType).id);
	} else {
		types.push(dex.types.get(species.types[0]).id);
	}
	details.push(typeToPoint[types[0]]);
	details.push(typeToPoint[types[0]]);
	if (set.teraType && dex.types.get(set.teraType).exists) {
		types.push(dex.types.get(set.teraType).id);
	} else if (species.types.length > 1) {
		types.push(dex.types.get(species.types[1]).id);
	}
	if (types.length < 2 || types[1] === types[0]) {
		details[4] *= 1.5;
		details.push(-1);
	} else {
		details[4] += typeToPoint[types[1]];
		details.push(typeToPoint[types[1]]);
	}

	// ability points
	const abilityPoint = abilityToPoint[dex.abilities.get(set.ability).id] || 1;
	details.push(abilityPoint);

	// move points
	// mem: maybe all moves like fly should have 1 point
	details.push(0);
	for (const move of set.moves) {
		const point = moveToPoint[dex.moves.get(move).id] || 0.5;
		details.push(point);
		details[8] += point;
	}
	for (let i = set.moves.length; i < 4; ++i) {
		details.push(0.5);
		details[8] += 0.5;
	}

	// penalty
	// details.push(0);
	// let statName: StatID;
	// for (statName in set.evs) {
	// 	const stat = set.evs[statName];
	// 	const penalty = calcPnPoint(stat);
	// 	details[12] += penalty;
	// 	if (statName === 'hp') details[12] += penalty;
	// 	details.push(penalty);
	// }

	return details;
}
